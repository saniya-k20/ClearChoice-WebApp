<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saved Products</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
        padding-bottom: 100px;
      }
      .saved-products-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      h1 {
        color: #FF6B6B;
        text-align: center;
        margin-bottom: 30px;
      }
      .search-bar {
        position: relative;
        margin-bottom: 20px;
      }
      .search-bar input {
        width: 100%;
        padding: 12px 20px;
        border-radius: 25px;
        border: 1px solid #ddd;
        font-size: 16px;
        padding-left: 45px;
      }
      .search-bar i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #777;
      }
      .saved-products-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }
      .product-item {
        background-color: white;
        border-radius: 15px;
        padding: 15px;
        display: flex;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      .product-item img {
        width: 80px;
        height: 80px;
        border-radius: 10px;
        object-fit: cover;
        margin-right: 15px;
      }
      .product-details {
        flex: 1;
      }
      .product-details h3 {
        margin: 0 0 5px 0;
        color: #3B375A;
      }
      .product-details p {
        margin: 0;
        color: #666;
        font-size: 14px;
      }
      .remove-button {
        background: none;
        border: none;
        color: #FF6B6B;
        font-size: 18px;
        cursor: pointer;
        padding: 10px;
      }
      .analysis-item {
        background-color: white;
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      .analysis-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }
      .analysis-date {
        color: #777;
        font-size: 14px;
      }
      .rating-summary {
        display: flex;
        justify-content: space-around;
        margin: 10px 0;
        text-align: center;
      }
      .rating-box {
        padding: 10px;
        border-radius: 10px;
        width: 30%;
        font-size: 14px;
      }
      .bad-summary {
        background-color: #f8d7da;
        color: #721c24;
      }
      .moderate-summary {
        background-color: #fff3cd;
        color: #856404;
      }
      .good-summary {
        background-color: #d4edda;
        color: #155724;
      }
      .ingredient-list {
        margin-top: 10px;
      }
      .ingredient-item {
        padding: 10px;
        margin: 8px 0;
        border-radius: 8px;
        display: flex;
        align-items: center;
        font-size: 14px;
      }
      .ingredient-icon {
        margin-right: 10px;
      }
      /* Bottom Navigation */
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: white;
        display: flex;
        justify-content: space-around;
        padding: 10px 0;
        box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        z-index: 100;
      }
      .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: #3B375A;
        font-size: 12px;
      }
      .nav-item i {
        font-size: 20px;
        margin-bottom: 5px;
      }
      .nav-item.active {
        color: #FF6B6B;
      }
      /* Side Menu */
      .side-menu {
        position: fixed;
        top: 0;
        left: -250px;
        width: 250px;
        height: 100%;
        background-color: white;
        z-index: 1000;
        transition: left 0.3s ease;
        box-shadow: 2px 0 5px rgba(0,0,0,0.1);
      }
      .side-menu.open {
        left: 0;
      }
      .menu-content {
        padding: 20px;
      }
      .menu-item {
        display: flex;
        align-items: center;
        padding: 12px 0;
        color: #3B375A;
        text-decoration: none;
      }
      .menu-item i {
        margin-right: 15px;
        width: 20px;
        text-align: center;
      }
      .menu-divider {
        height: 1px;
        background-color: #eee;
        margin: 15px 0;
      }
      .logout-button {
        color: #FF6B6B;
      }
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        z-index: 999;
        display: none;
      }
      .overlay.show {
        display: block;
      }
      .menu-icon {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1001;
        font-size: 24px;
        color: #3B375A;
        cursor: pointer;
      }
    </style>
</head>
<body>
    <!-- Side Menu Icon at Top Left -->
    <div class="menu-icon" id="top-menu-icon">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Side Menu -->
    <div class="side-menu" id="side-menu">
        <!-- Menu Options -->
        <div class="menu-content">
          <a href="index.php" class="menu-item">
            <i class="fas fa-home"></i>
            <span>Home</span>
          </a>
          <a href="user-profile.html" class="menu-item">
            <i class="fas fa-user"></i>
            <span>Profile</span>
          </a>
          <a href="settings.html" class="menu-item">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
          </a>
          <a href="user-guide.html" class="menu-item">
            <i class="fas fa-book"></i>
            <span>User Guide</span>
          </a>
          <a href="about-us.html" class="menu-item">
            <i class="fas fa-info-circle"></i>
            <span>About Us</span>
          </a>
          <a href="contact-us.html" class="menu-item">
            <i class="fas fa-phone"></i>
            <span>Contact Us</span>
          </a>
      
          <!-- Divider -->
          <div class="menu-divider"></div>
      
          <!-- Logout Button -->
          <a href="logout.php" class="menu-item logout-button">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
          </a>
        </div>
      </div>
      
      <!-- Overlay -->
      <div class="overlay" id="overlay"></div>

    <!-- Saved Products Page Content -->
    <main class="saved-products-container">
        <h1>Saved Analyses</h1>

        <!-- Search Bar -->
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Search saved analyses...">
            <i class="fas fa-search"></i>
        </div>

        <!-- Saved Analyses List -->
        <div class="saved-products-list" id="saved-analyses-list">
            <!-- Analyses will be added here dynamically -->
        </div>
    </main>

    <!-- Bottom Navigation Bar -->
    <footer class="bottom-nav">
        <a href="favourites.html" class="nav-item active">
            <i class="fas fa-heart"></i>
            <span>Favorites</span>
        </a>
        <a href="index.php" class="nav-item">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a href="user-profile.html" class="nav-item">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
    </footer>

    <script>
      // Side menu functionality
      document.getElementById('top-menu-icon').addEventListener('click', function() {
        document.getElementById('side-menu').classList.toggle('open');
        document.getElementById('overlay').classList.toggle('show');
      });
      
      document.getElementById('overlay').addEventListener('click', function() {
        document.getElementById('side-menu').classList.remove('open');
        this.classList.remove('show');
      });
      
      // Load saved analyses
      document.addEventListener('DOMContentLoaded', function() {
        const savedAnalyses = JSON.parse(localStorage.getItem('savedAnalyses')) || [];
        const container = document.getElementById('saved-analyses-list');
        
        if (savedAnalyses.length === 0) {
          container.innerHTML = '<p style="text-align: center; color: #666;">No saved analyses yet</p>';
          return;
        }
        
        container.innerHTML = '';
        
        savedAnalyses.forEach((analysis, index) => {
          const analysisElement = document.createElement('div');
          analysisElement.className = 'analysis-item';
          
          let ingredientsHTML = '';
          analysis.ingredients.forEach(ingredient => {
            ingredientsHTML += `
              <div class="ingredient-item ${ingredient.rating}">
                <span class="ingredient-icon">${ingredient.icon}</span>
                <div>
                  <strong>${ingredient.name}</strong><br>
                  ${ingredient.description}
                </div>
              </div>
            `;
          });
          
          analysisElement.innerHTML = `
            <div class="analysis-header">
              <div>
                <h3 class="analysis-title">${analysis.name}</h3>
                <div class="analysis-product">Product Analysis</div>
              </div>
              <span class="analysis-date">${analysis.date}</span>
            </div>
            <div class="rating-summary">
              <div class="rating-box bad-summary">
                <div>üö´ Bad</div>
                <div>${analysis.badCount}</div>
              </div>
              <div class="rating-box moderate-summary">
                <div>‚ö†Ô∏è Moderate</div>
                <div>${analysis.moderateCount}</div>
              </div>
              <div class="rating-box good-summary">
                <div>‚úÖ Good</div>
                <div>${analysis.goodCount}</div>
              </div>
            </div>
            <div class="ingredient-list">
              ${ingredientsHTML}
            </div>
            <button class="remove-button" data-index="${index}">
              <i class="fas fa-trash"></i> Remove
            </button>
          `;
          
          container.appendChild(analysisElement);
        });
        
        // Add event listeners to remove buttons
        document.querySelectorAll('.remove-button').forEach(button => {
          button.addEventListener('click', function() {
            const index = parseInt(this.getAttribute('data-index'));
            if (confirm('Are you sure you want to remove this analysis?')) {
              removeAnalysis(index);
            }
          });
        });
        
        // Search functionality - now searches by name
        document.getElementById('search-input').addEventListener('input', function() {
          const searchTerm = this.value.toLowerCase();
          const items = document.querySelectorAll('.analysis-item');
          
          items.forEach(item => {
            const title = item.querySelector('.analysis-title').textContent.toLowerCase();
            if (title.includes(searchTerm)) {
              item.style.display = 'block';
            } else {
              item.style.display = 'none';
            }
          });
        });
      });
      
      function removeAnalysis(index) {
        let savedAnalyses = JSON.parse(localStorage.getItem('savedAnalyses')) || [];
        savedAnalyses.splice(index, 1);
        localStorage.setItem('savedAnalyses', JSON.stringify(savedAnalyses));
        location.reload(); // Refresh to show updated list
      }
    </script>
</body>
</html>